# UbiOps
#
# Client Library to interact with the UbiOps API.
#
# UbiOps API version: v2.1
# Generated by custom generator based on: https://openapi-generator.tech

# Deployments operations


#' @title Get build
#' @description Retrieve details of a single build of a version
#' @param build.id  character
#' @param deployment.name  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A dictionary containing details of the build
#'   - `id`: Unique identifier for the build (UUID)
#'   - `revision`: UUID of the revision to which the build is linked
#'   - `creation_date`: The date when the build was created
#'   - `status`: Status of the build. Can be 'queued', 'building', 'deploying', 'validating', 'success' or 'failed'.
#'   - `error_message`: Error message which explains why the build has failed. It is empty if the build is successful.
#'   - `trigger`: Action that triggered the build
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::builds_get(
#'    build.id, deployment.name, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::builds_get(
#'    build.id, deployment.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
builds_get <- function(build.id, deployment.name, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`build.id`)) {
    stop("Missing required parameter `build.id`.")
  }
  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/builds/{build_id}"
  if (!missing(`build.id`)) {
    url_path <- gsub("\\{build_id\\}", utils::URLencode(as.character(`build.id`), reserved = TRUE), url_path)
  }
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List builds
#' @description List all builds associated with a version. A build is triggered when a new deployment file is uploaded.
#' @param deployment.name  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of details of the builds
#'   - `id`: Unique identifier for the build (UUID)
#'   - `revision`: UUID of the revision to which the build is linked
#'   - `creation_date`: The date when the build was created
#'   - `status`: Status of the build. Can be 'queued', 'building', 'deploying', 'validating', 'success' or 'failed'.
#'   - `error_message`: Error message which explains why the build has failed. It is empty if the build is successful.
#'   - `trigger`: Action that triggered the build
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::builds_list(
#'    deployment.name, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::builds_list(
#'    deployment.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
builds_list <- function(deployment.name, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/builds"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List audit events for a deployment
#' @description List all audit events for a deployment including versions
#' @param deployment.name  character
#' @param action (optional) character
#' @param limit (optional) integer
#' @param offset (optional) integer
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of details of the audit events for a deployment
#'   - `id`: Unique identifier for the audit event (UUID)
#'   - `date`: The date when the action was performed
#'   - `action`: Type of action. It can be one of: create, update, delete, info. *info* action denotes that the action does not fall into create, update or delete categories.
#'   - `user`: Email of the user who performed the action
#'   - `event`: Description of the event
#'   - `object_type`: Type of the object on which the action was performed
#'   - `object_name`: Name of the object on which the action was performed. If the object is deleted at the time of listing audit events, this field is empty.
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_audit_events_list(
#'    deployment.name,
#'    action = NULL, limit = NULL, offset = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_audit_events_list(
#'    deployment.name,
#'    action = NULL, limit = NULL, offset = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_audit_events_list <- function(deployment.name, action=NULL, limit=NULL, offset=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  query_params['action'] <- action
  query_params['limit'] <- limit
  query_params['offset'] <- offset
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/audit"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Copy deployment environment variable
#' @description Copy existing environment variables from a source object to the deployment. Variables of the deployment with the same name as ones from the source object will be overwritten with the new value. Only the copied variables are returned.
#' @param deployment.name  character
#' @param data  named list of: [ source_deployment, source_version (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of the copied variables described by the following fields:
#'   - `id`: Unique identifier for the environment variable
#'   - `name`: Variable name
#'   - `value`: Variable value (will be null for secret variables)
#'   - `secret`: Boolean that indicates if this variable contains sensitive information
#'   - `inheritance_type`: Type of parent object that this variable is inherited from. Will be null for copied environment variables.
#'   - `inheritance_name`: Name of the parent object that this variable is inherited from. Will be null for copied environment variables.
#' @examples
#' \dontrun{
#' data <- list(
#'  source_deployment = "source_deployment",
#'  source_version = "source_version"  # (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_environment_variables_copy(
#'    deployment.name, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_environment_variables_copy(
#'    deployment.name, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_environment_variables_copy <- function(deployment.name, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/copy-environment-variables"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create deployment environment variable
#' @description Create an environment variable for the deployment. This variable will be inherited by all versions of this deployment. Variables inherited from the project can be shadowed by creating a variable with the same name.
#' @param deployment.name  character
#' @param data  named list of: [ name, value (optional), secret ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of variables described by the following fields:
#'   - `id`: Unique identifier for the environment variable
#'   - `name`: Variable name
#'   - `value`: Variable value (will be null for secret variables)
#'   - `secret`: Boolean that indicates if this variable contains sensitive information
#' @examples
#' \dontrun{
#' data <- list(
#'  name = "name",
#'  value = "value",  # (optional)
#'  secret = FALSE
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_environment_variables_create(
#'    deployment.name, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_environment_variables_create(
#'    deployment.name, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_environment_variables_create <- function(deployment.name, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/environment-variables"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete deployment environment variable
#' @description Delete an environment variable of the deployment
#' @param deployment.name  character
#' @param id  character
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' ubiops::deployment_environment_variables_delete(
#'    deployment.name, id
#' )
#' 
#' # Or provide directly
#' ubiops::deployment_environment_variables_delete(
#'    deployment.name, id,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_environment_variables_delete <- function(deployment.name, id,  ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`id`)) {
    stop("Missing required parameter `id`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/environment-variables/{id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`id`)) {
    url_path <- gsub("\\{id\\}", utils::URLencode(as.character(`id`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "DELETE", NULL, query_params, ...)
  return(invisible(NULL))
}


#' @title Get deployment environment variable
#' @description Retrieve details of a deployment environment variable. This cannot be used to retrieve details of inherited variables.
#' @param deployment.name  character
#' @param id  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of variables described by the following fields:
#'   - `id`: Unique identifier for the environment variable
#'   - `name`: Variable name
#'   - `value`: Variable value (will be null for secret variables)
#'   - `secret`: Boolean that indicates if this variable contains sensitive information
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_environment_variables_get(
#'    deployment.name, id
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_environment_variables_get(
#'    deployment.name, id,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_environment_variables_get <- function(deployment.name, id,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`id`)) {
    stop("Missing required parameter `id`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/environment-variables/{id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`id`)) {
    url_path <- gsub("\\{id\\}", utils::URLencode(as.character(`id`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List deployment environment variables
#' @description List the environment variables defined for the deployment. Includes environment variables defined at project level.
#' @param deployment.name  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of variables described by the following fields:
#'   - `id`: Unique identifier for the environment variable
#'   - `name`: Variable name
#'   - `value`: Variable value (will be null for secret variables)
#'   - `secret`: Boolean that indicates if this variable contains sensitive information
#'   - `inheritance_type`: Type of parent object that this variable is inherited from - can be `project` or null if the variable was defined for the deployment directly
#'   - `inheritance_name`: Name of the parent object that this variable is inherited from - will be null if the variable was defined for the deployment directly
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_environment_variables_list(
#'    deployment.name
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_environment_variables_list(
#'    deployment.name,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_environment_variables_list <- function(deployment.name,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/environment-variables"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Update deployment environment variable
#' @description Update an environment variable for the deployment. This cannot be used to update inherited variables; to change an inherited variable for a specific deployment you can create a variable with the same name for the deployment.
#' @param deployment.name  character
#' @param id  character
#' @param data  named list of: [ name, value (optional), secret ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of variables described by the following fields:
#'   - `id`: Unique identifier for the environment variable
#'   - `name`: Variable name
#'   - `value`: Variable value (will be null for secret variables)
#'   - `secret`: Boolean that indicates if this variable contains sensitive information
#' @examples
#' \dontrun{
#' data <- list(
#'  name = "name",
#'  value = "value",  # (optional)
#'  secret = FALSE
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_environment_variables_update(
#'    deployment.name, id, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_environment_variables_update(
#'    deployment.name, id, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_environment_variables_update <- function(deployment.name, id, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`id`)) {
    stop("Missing required parameter `id`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/environment-variables/{id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`id`)) {
    url_path <- gsub("\\{id\\}", utils::URLencode(as.character(`id`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "PATCH", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Copy deployment version environment variable
#' @description Copy existing environment variables from a source object to the deployment version. Variables of the deployment version with the same name as ones from the source object will be overwritten with the new value. Only the copied variables are returned.
#' @param deployment.name  character
#' @param version  character
#' @param data  named list of: [ source_deployment, source_version (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of the copied variables described by the following fields:
#'   - `id`: Unique identifier for the environment variable
#'   - `name`: Variable name
#'   - `value`: Variable value (will be null for secret variables)
#'   - `secret`: Boolean that indicates if this variable contains sensitive information
#'   - `inheritance_type`: Type of parent object that this variable is inherited from. Will be null for copied environment variables.
#'   - `inheritance_name`: Name of the parent object that this variable is inherited from. Will be null for copied environment variables.
#' @examples
#' \dontrun{
#' data <- list(
#'  source_deployment = "source_deployment",
#'  source_version = "source_version"  # (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_version_environment_variables_copy(
#'    deployment.name, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_version_environment_variables_copy(
#'    deployment.name, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_environment_variables_copy <- function(deployment.name, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/copy-environment-variables"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create deployment version environment variable
#' @description Create an environment variable for the deployment version. Variables inherited from the project or deployment can be shadowed by creating a variable with the same name.
#' @param deployment.name  character
#' @param version  character
#' @param data  named list of: [ name, value (optional), secret ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of variables described by the following fields:
#'   - `id`: Unique identifier for the environment variable
#'   - `name`: Variable name
#'   - `value`: Variable value (will be null for secret variables)
#'   - `secret`: Boolean that indicates if this variable contains sensitive information
#' @examples
#' \dontrun{
#' data <- list(
#'  name = "name",
#'  value = "value",  # (optional)
#'  secret = FALSE
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_version_environment_variables_create(
#'    deployment.name, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_version_environment_variables_create(
#'    deployment.name, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_environment_variables_create <- function(deployment.name, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/environment-variables"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete deployment version environment variable
#' @description Delete an environment variable of a deployment version
#' @param deployment.name  character
#' @param id  character
#' @param version  character
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' ubiops::deployment_version_environment_variables_delete(
#'    deployment.name, id, version
#' )
#' 
#' # Or provide directly
#' ubiops::deployment_version_environment_variables_delete(
#'    deployment.name, id, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_environment_variables_delete <- function(deployment.name, id, version,  ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`id`)) {
    stop("Missing required parameter `id`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/environment-variables/{id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`id`)) {
    url_path <- gsub("\\{id\\}", utils::URLencode(as.character(`id`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "DELETE", NULL, query_params, ...)
  return(invisible(NULL))
}


#' @title Get deployment version environment variable
#' @description Retrieve details of a deployment version environment variable. This cannot be used to retrieve details of inherited variables.
#' @param deployment.name  character
#' @param id  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of variables described by the following fields:
#'   - `id`: Unique identifier for the environment variable
#'   - `name`: Variable name
#'   - `value`: Variable value (will be null for secret variables)
#'   - `secret`: Boolean that indicates if this variable contains sensitive information
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_version_environment_variables_get(
#'    deployment.name, id, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_version_environment_variables_get(
#'    deployment.name, id, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_environment_variables_get <- function(deployment.name, id, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`id`)) {
    stop("Missing required parameter `id`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/environment-variables/{id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`id`)) {
    url_path <- gsub("\\{id\\}", utils::URLencode(as.character(`id`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List deployment version environment variables
#' @description List the environment variables defined for the deployment version. Includes environment variables defined at project level and deployment level.
#' @param deployment.name  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of variables described by the following fields:
#'   - `id`: Unique identifier for the environment variable
#'   - `name`: Variable name
#'   - `value`: Variable value (will be null for secret variables)
#'   - `secret`: Boolean that indicates if this variable contains sensitive information
#'   - `inheritance_type`: Type of parent object that this variable is inherited from - can be `project`, `deployment`, or null if the variable was defined for the version directly
#'   - `inheritance_name`: Name of the parent object that this variable is inherited from - will be null if the variable was defined for the version directly
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_version_environment_variables_list(
#'    deployment.name, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_version_environment_variables_list(
#'    deployment.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_environment_variables_list <- function(deployment.name, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/environment-variables"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Update deployment version environment variable
#' @description Update an environment variable for the deployment version. This cannot be used to update inherited variables; to change an inherited variable for a specific version you can create a variable with the same name for the deployment version.
#' @param deployment.name  character
#' @param id  character
#' @param version  character
#' @param data  named list of: [ name, value (optional), secret ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of variables described by the following fields:
#'   - `id`: Unique identifier for the environment variable
#'   - `name`: Variable name
#'   - `value`: Variable value (will be null for secret variables)
#'   - `secret`: Boolean that indicates if this variable contains sensitive information
#' @examples
#' \dontrun{
#' data <- list(
#'  name = "name",
#'  value = "value",  # (optional)
#'  secret = FALSE
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_version_environment_variables_update(
#'    deployment.name, id, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_version_environment_variables_update(
#'    deployment.name, id, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_environment_variables_update <- function(deployment.name, id, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`id`)) {
    stop("Missing required parameter `id`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/environment-variables/{id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`id`)) {
    url_path <- gsub("\\{id\\}", utils::URLencode(as.character(`id`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "PATCH", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create deployment versions
#' @description Create a version for a deployment. The first version of a deployment is set as default. Provide the parameter 'monitoring' as the name of a notification group to send monitoring notifications to. A notification will be sent in the case of a failed/recovered request. Pass `null` to switch off monitoring notifications for this version. Provide the parameter 'default_notification_group' as the name of a notification group to send notifications when requests for the version are completed. Pass `null` to switch off request notifications for this version. This field is only used for versions with **batch deployment mode**.
#' @param deployment.name  character
#' @param data  named list of: [ version, language (optional), memory_allocation (optional), instance_type (optional), maximum_instances (optional), minimum_instances (optional), maximum_idle_time (optional), description (optional), labels (optional), monitoring (optional), request_retention_time (optional), request_retention_mode (optional), deployment_mode (optional), default_notification_group (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the created version
#'   - `id`: Unique identifier for the deployment (UUID)
#'   - `deployment`: Deployment name to which the version is associated
#'   - `version`: Version name
#'   - `description`: Description of the version
#'   - `language`: Language in which the version is provided
#'   - `status`: The status of the version
#'   - `active_revision`: Active revision of the version. It is initialised as None since there are no deployment files uploaded for the version yet.
#'   - `latest_build`: Latest build of the version. It is initialised as None since no build is triggered for the version yet.
#'   - `memory_allocation`: (deprecated) Reserved memory for the version in MiB
#'   - `instance_type`: The reserved instance type for the version
#'   - `maximum_instances`: Upper bound of number of versions running
#'   - `minimum_instances`: Lower bound of number of versions running
#'   - `maximum_idle_time`: Maximum time in seconds a version stays idle before it is stopped
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the version was created
#'   - `last_updated`: The date when the version was last updated
#'   - `monitoring`: Name of a notification group which contain contacts to send monitoring notifications
#'   - `default_notification_group`: Name of a notification group which contain contacts to send notifications when requests for the version are completed
#'   - `request_retention_time`: Number of seconds to store requests to the version
#'   - `request_retention_mode`: Mode of request retention for requests to the version. It can be one of the following: *none*, *metadata* or *full*.
#'   - `deployment_mode`: the type of the deployment version
#' @examples
#' \dontrun{
#' data <- list(
#'  version = "version",
#'  language = 'python3.7',  # (optional)
#'  memory_allocation = 0,  # (optional)
#'  instance_type = "instance_type",  # (optional)
#'  maximum_instances = 0,  # (optional)
#'  minimum_instances = 0,  # (optional)
#'  maximum_idle_time = 0,  # (optional)
#'  description = "description",  # (optional)
#'  labels = list(key = "value"),  # (optional)
#'  monitoring = "monitoring",  # (optional)
#'  request_retention_time = 0,  # (optional)
#'  request_retention_mode = 'full',  # one of: [none, metadata, full]  (optional)
#'  deployment_mode = 'express',  # one of: [express, batch]  (optional)
#'  default_notification_group = "default_notification_group"  # (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_versions_create(
#'    deployment.name, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_versions_create(
#'    deployment.name, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_versions_create <- function(deployment.name, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete deployment version
#' @description Delete a deployment version. The version cannot be deleted if: - It is referenced in a pipeline, it must be removed from the pipeline first. - It is the default version of its deployment and is referenced in a request schedule.
#' @param deployment.name  character
#' @param version  character
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' ubiops::deployment_versions_delete(
#'    deployment.name, version
#' )
#' 
#' # Or provide directly
#' ubiops::deployment_versions_delete(
#'    deployment.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_versions_delete <- function(deployment.name, version,  ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "DELETE", NULL, query_params, ...)
  return(invisible(NULL))
}


#' @title Get deployment version
#' @description Retrieve details of a version of a deployment in a project
#' @param deployment.name  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of a version
#'   - `id`: Unique identifier for the version (UUID)
#'   - `deployment`: Deployment name to which the version is associated
#'   - `version`: Version name
#'   - `description`: Description of the version
#'   - `language`: Language in which the version is provided
#'   - `status`: The status of the version
#'   - `active_revision`: UUID of the active revision of the version. If no deployment files have been uploaded yet, it is None.
#'   - `latest_build`: UUID of the latest build of the version. If no build has been triggered yet, it is None.
#'   - `memory_allocation`: (deprecated) Reserved memory for the version in MiB
#'   - `instance_type`: The reserved instance type for the version
#'   - `maximum_instances`: Upper bound of number of deployment pods running in parallel
#'   - `minimum_instances`: Lower bound of number of deployment pods running in parallel
#'   - `maximum_idle_time`: Maximum time in seconds a version stays idle before it is stopped
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the version was created
#'   - `last_updated`: The date when the version was last updated
#'   - `last_file_upload`: The date when a deployment file was last uploaded for the version
#'   - `monitoring`: Name of a notification group which contain contacts to send monitoring notifications
#'   - `default_notification_group`: Name of a notification group which contain contacts to send notifications when requests for the version are completed
#'   - `request_retention_time`: Number of seconds to store requests to the version
#'   - `request_retention_mode`: Mode of request retention for requests to the version. It can be one of the following:
#'       - *none* - the requests will not be stored
#'       - *metadata* - only the metadata of the requests will be stored
#'       - *full* - both the metadata and input/output of the requests will be stored 
#'   - `deployment_mode`: the type of the deployment version
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_versions_get(
#'    deployment.name, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_versions_get(
#'    deployment.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_versions_get <- function(deployment.name, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List deployment versions
#' @description Versions can be filtered according to the labels they have by giving labels as a query parameter. Versions that have at least one of the labels on which is filtered, are returned.
#' @param deployment.name  character
#' @param labels (optional) character - Example: "label1:value1,label2:value2"
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of details of the versions
#'   - `id`: Unique identifier for the deployment (UUID)
#'   - `deployment`: Deployment name to which the version is associated
#'   - `version`: Version name
#'   - `description`: Description of the version
#'   - `language`: Language in which the version is provided
#'   - `status`: The status of the version
#'   - `active_revision`: UUID of the active revision of the version. If no deployment files have been uploaded yet, it is None.
#'   - `latest_build`: UUID of the latest build of the version. If no build has been triggered yet, it is None.
#'   - `memory_allocation`: (deprecated) Reserved memory usage for the version in MiB
#'   - `instance_type`: The reserved instance type for the version
#'   - `maximum_instances`: Upper bound of number of versions running
#'   - `minimum_instances`: Lower bound of number of versions running
#'   - `maximum_idle_time`: Maximum time in seconds a version stays idle before it is stopped
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the version was created
#'   - `last_updated`: The date when the version was last updated
#'   - `monitoring`: Name of a notification group which contain contacts to send monitoring notifications
#'   - `default_notification_group`: Name of a notification group which contain contacts to send notifications when requests for the version are completed
#'   - `request_retention_time`: Number of seconds to store requests to the version
#'   - `request_retention_mode`: Mode of request retention for requests to the version. It can be one of the following:
#'       - *none* - the requests will not be stored
#'       - *metadata* - only the metadata of the requests will be stored
#'       - *full* - both the metadata and input/output of the requests will be stored
#'   - `deployment_mode`: the type of the deployment version
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_versions_list(
#'    deployment.name,
#'    labels = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_versions_list(
#'    deployment.name,
#'    labels = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_versions_list <- function(deployment.name, labels=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  query_params['labels'] <- labels
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Update deployment version
#' @description Update a version of a deployment in a project. All necessary fields are validated again. When updating labels, the labels will replace the existing value for labels. Provide the parameter 'monitoring' as the name of a notification group to send monitoring notifications to. A notification will be sent in the case of a failed/recovered request. Pass `null` to switch off monitoring notifications for this version. Provide the parameter 'default_notification_group' as the name of a notification group to send notifications when requests for the version are completed. Pass `null` to switch off request notifications for this version. This field is only used for versions with **batch deployment mode**.
#' @param deployment.name  character
#' @param version  character
#' @param data  named list of: [ version (optional), memory_allocation (optional), instance_type (optional), maximum_instances (optional), minimum_instances (optional), maximum_idle_time (optional), description (optional), labels (optional), monitoring (optional), request_retention_time (optional), request_retention_mode (optional), default_notification_group (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the updated version
#'   - `id`: Unique identifier for the deployment (UUID)
#'   - `deployment`: Deployment name to which the version is associated
#'   - `version`: Version name
#'   - `description`: Description of the version
#'   - `language`: Language in which the version is provided
#'   - `status`: The status of the version
#'   - `active_revision`: UUID of the active revision of the version. If no deployment files have been uploaded yet, it is None.
#'   - `latest_build`: UUID of the latest build of the version. If no build has been triggered yet, it is None.
#'   - `memory_allocation`: (deprecated) Reserved memory for the version in MiB
#'   - `instance_type`: The reserved instance type for the version
#'   - `maximum_instances`: Upper bound of number of versions running
#'   - `minimum_instances`: Lower bound of number of versions running
#'   - `maximum_idle_time`: Maximum time in seconds a version stays idle before it is stopped
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the version was created
#'   - `last_updated`: The date when the version was last updated
#'   - `last_file_upload`: The date when a deployment file was last uploaded for the version
#'   - `monitoring`: Name of a notification group which contain contacts to send monitoring notifications
#'   - `default_notification_group`: Name of a notification group which contain contacts to send notifications when requests for the version are completed
#'   - `request_retention_time`: Number of seconds to store requests to the version
#'   - `request_retention_mode`: Mode of request retention for requests to the version. It can be one of the following: *none*, *metadata* or *full*.
#'   - `deployment_mode`: the type of the deployment version
#' @examples
#' \dontrun{
#' data <- list(
#'  version = "version",  # (optional)
#'  memory_allocation = 0,  # (optional)
#'  instance_type = "instance_type",  # (optional)
#'  maximum_instances = 0,  # (optional)
#'  minimum_instances = 0,  # (optional)
#'  maximum_idle_time = 0,  # (optional)
#'  description = "description",  # (optional)
#'  labels = list(key = "value"),  # (optional)
#'  monitoring = "monitoring",  # (optional)
#'  request_retention_time = 0,  # (optional)
#'  request_retention_mode = "request_retention_mode",  # one of: [none, metadata, full]  (optional)
#'  default_notification_group = "default_notification_group"  # (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_versions_update(
#'    deployment.name, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_versions_update(
#'    deployment.name, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_versions_update <- function(deployment.name, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "PATCH", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create deployments
#' @description Create a deployment by defining the input/output type and input/output fields. In case of **plain** type of input or output, input and output fields should not be given or passed as an empty list.  Possible data types for the input and output fields are: - **int**: integer - **string**: string - **double**: double precision floating point - **bool**: boolean value (False/True) - **timestamp**: timestamp - **array_int**: an array of integers - **array_double**: an array of double precision floating points - **array_string**: an array of strings - **blob**: a blob field. This type of field can be used to pass blobs to the deployment. In deployment and pipeline requests, the uuid of a previously uploaded blob must be provided for this field.  Possible widgets for the input fields are: - **textbox**: textbox - **numberbox**: numberbox - **slider**: slider - **dropdown**: dropdown - **switch**: switch - **button**: upload button - **drawer**: drawer - **image_preview**: image upload with preview  Possible widgets for the output fields are: - **textbox**: textbox - **button**: download button - **image_preview**: image preview
#' @param data  named list of: [ name, description (optional), input_type, output_type, input_fields (optional), output_fields (optional), labels (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the created deployment
#'   - `id`: Unique identifier for the deployment (UUID)
#'   - `name`: Name of the deployment
#'   - `project`: Project name in which the deployment is created
#'   - `input_type`: Type of the input of the deployment
#'   - `output_type`: Type of the output of the deployment
#'   - `input_fields`: The list of deployment input fields containing name and data_type
#'   - `output_fields`: The list of deployment output fields containing name and data_type
#'   - `description`: Description of the deployment
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the deployment was created
#'   - `last_updated`: The date when the deployment was last updated
#' @examples
#' \dontrun{
#' data <- list(
#'  name = "name",
#'  description = "description",  # (optional)
#'  input_type = "input_type",  # one of: [structured, plain] 
#'  output_type = "output_type",  # one of: [structured, plain] 
#'  input_fields = list(  # (optional)
#'    list(
#'      name = "name",
#'      data_type = "data_type",  # one of: [int, string, double, bool, array_int, array_double, array_string, blob] 
#'      widget = widget  # (optional)
#'    )
#'  ),
#'  output_fields = list(  # (optional)
#'    list(
#'      name = "name",
#'      data_type = "data_type",  # one of: [int, string, double, bool, array_int, array_double, array_string, blob] 
#'      widget = widget  # (optional)
#'    )
#'  ),
#'  labels = list(key = "value")  # (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployments_create(
#'    data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployments_create(
#'    data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployments_create <- function(data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments"

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete a deployment
#' @description Delete a deployment. If any of the versions of the deployment are referenced in a pipeline, the deployment cannot be deleted.
#' @param deployment.name  character
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' ubiops::deployments_delete(
#'    deployment.name
#' )
#' 
#' # Or provide directly
#' ubiops::deployments_delete(
#'    deployment.name,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployments_delete <- function(deployment.name,  ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "DELETE", NULL, query_params, ...)
  return(invisible(NULL))
}


#' @title Get details of a deployment
#' @description Retrieve details of a single deployment in a project
#' @param deployment.name  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of a deployment
#'   - `id`: Unique identifier for the deployment (UUID)
#'   - `name`: Name of the deployment
#'   - `project`: Project name in which the deployment is defined
#'   - `input_type`: Type of the input of the deployment
#'   - `output_type`: Type of the output of the deployment
#'   - `input_fields`: The list of deployment input fields containing name, data_type and widget
#'   - `output_fields`: The list of deployment output fields containing name, data_type and widget
#'   - `description`: Description of the deployment
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the deployment was created
#'   - `last_updated`: The date when the deployment was last updated
#'   - `default_version`: Default version of the deployment.  If it does not have a default version, it is not set.
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployments_get(
#'    deployment.name
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployments_get(
#'    deployment.name,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployments_get <- function(deployment.name,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List deployments
#' @description Deployments can be filtered according to the labels they have by giving labels as a query parameter. Deployments that have at least one of the labels on which is filtered, are returned.
#' @param labels (optional) character - Example: "label1:value1,label2:value2"
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of details of the deployments in the project
#'   - `id`: Unique identifier for the deployment (UUID)
#'   - `name`: Name of the deployment
#'   - `project`: Project name in which the deployment is defined
#'   - `input_type`: Type of the input of the deployment
#'   - `output_type`: Type of the output of the deployment
#'   - `input_fields`: The list of deployment input fields containing name and data_type. It is empty in case of plain input type deployments.
#'   - `output_fields`: The list of deployment output fields containing name and data_type. It is empty in case of plain output type deployments.
#'   - `description`: Description of the deployment
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the deployment was created
#'   - `last_updated`: The date when the deployment was last updated
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployments_list(
#'    
#'    labels = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployments_list(
#'    
#'    labels = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployments_list <- function(labels=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  query_params['labels'] <- labels
  
  url_path <- "/projects/{project_name}/deployments"

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Update a deployment
#' @description Update a deployment
#' @param deployment.name  character
#' @param data  named list of: [ name (optional), default_version (optional), description (optional), input_fields (optional), output_fields (optional), labels (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the updated deployment
#'   - `id`: Unique identifier for the deployment (UUID)
#'   - `name`: Name of the deployment
#'   - `project`: Project name in which the deployment is defined
#'   - `input_type`: Type of the input of the deployment
#'   - `output_type`: Type of the output of the deployment
#'   - `input_fields`: The list of deployment input fields containing name, data_type and (optional) widget
#'   - `output_fields`: The list of deployment output fields containing name, data_type and (optional) widget
#'   - `description`: Description of the deployment
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the deployment was created
#'   - `last_updated`: The date when the deployment was last updated
#'   - `default_version`: Default version of the deployment. If it does not have a default version, it is not set.
#' @examples
#' \dontrun{
#' data <- list(
#'  name = "name",  # (optional)
#'  default_version = "default_version",  # (optional)
#'  description = "description",  # (optional)
#'  input_fields = list(  # (optional)
#'    list(
#'      name = "name",
#'      data_type = "data_type",  # one of: [int, string, double, bool, array_int, array_double, array_string, blob] 
#'      widget = widget  # (optional)
#'    )
#'  ),
#'  output_fields = list(  # (optional)
#'    list(
#'      name = "name",
#'      data_type = "data_type",  # one of: [int, string, double, bool, array_int, array_double, array_string, blob] 
#'      widget = widget  # (optional)
#'    )
#'  ),
#'  labels = list(key = "value")  # (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployments_update(
#'    deployment.name, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployments_update(
#'    deployment.name, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployments_update <- function(deployment.name, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "PATCH", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Download deployment file
#' @description Download the deployment file of a revision of a version
#' @param deployment.name  character
#' @param revision.id  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the output file is loaded and written to the storage location defined by UBIOPS_TEMP_FOLDER_PATH. When FALSE, unprocessed API response object is returned. - Default = FALSE
#' @param ...
#'  UBIOPS_TEMP_FOLDER_PATH (system environment variable) Storage location for output file when `preload_content` is set to TRUE - Default = current working directory
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::revisions_file_download(
#'    deployment.name, revision.id, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::revisions_file_download(
#'    deployment.name, revision.id, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # Save file manually
#' file_name <- result$getFileName()
#' 
#' output <- file(file.path(getwd(), file_name), "wb")
#' readr::write_file(result$getContent(), output)
#' close(output)
#' 
#' # Or save file directly in temp folder
#' # by using environment variables or providing directly
#' Sys.setenv("UBIOPS_TEMP_FOLDER_PATH" = getwd())
#' output_path <- ubiops::revisions_file_download(
#'   deployment.name, revision.id, version,
#'   preload_content=TRUE
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
revisions_file_download <- function(deployment.name, revision.id, version,  preload_content=FALSE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`revision.id`)) {
    stop("Missing required parameter `revision.id`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/revisions/{revision_id}/download"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`revision.id`)) {
    url_path <- gsub("\\{revision_id\\}", utils::URLencode(as.character(`revision.id`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserialize_file(api.response, ...)

  } else {
    ApiFileResponse$new(api.response)
  }
}


#' @title Upload deployment file
#' @description Upload a deployment file for a version. Uploading a deployment file will create a new revision and trigger a build. This file should contain the deployment that will be run. It should be provided as a zip and a template can be found on https://github.com/UbiOps/deployment-template. The file is saved under a directory in the storage specified in the settings.   It is **also possible** to provide a source version from which the deployment file will be copied. This will also create a new revision and trigger a build.
#' @param deployment.name  character
#' @param version  character
#' @param file (optional) file path - Example: file.path("path", "to", "file")
#' @param source.deployment (optional) character
#' @param source.version (optional) character
#' @param template.deployment.id (optional) character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  - `success`: Boolean indicating whether the deployment file upload/copy succeeded or not
#'   - `revision`: UUID of the created revision for the file upload
#'   - `build`: UUID of the build created for the file upload
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::revisions_file_upload(
#'    deployment.name, version,
#'    file = NULL, source.deployment = NULL, source.version = NULL, template.deployment.id = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::revisions_file_upload(
#'    deployment.name, version,
#'    file = NULL, source.deployment = NULL, source.version = NULL, template.deployment.id = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
revisions_file_upload <- function(deployment.name, version, file=NULL, source.deployment=NULL, source.version=NULL, template.deployment.id=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  body <- list(
    "file" = if (!is.null(`file`)) httr::upload_file(file) else NULL,
    "source_deployment" = source.deployment,
    "source_version" = source.version,
    "template_deployment_id" = template.deployment.id
  )
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/revisions"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, content_type = httr::content_type("multipart/form-data"), ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Get revision
#' @description Retrieve details of a single revision of a version
#' @param deployment.name  character
#' @param revision.id  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A dictionary containing details of the build
#'   - `id`: Unique identifier for the revision (UUID)
#'   - `version`: Version to which the revision is linked
#'   - `creation_date`: The date when the revision was created
#'   - `created_by`: The email of the user that uploaded the deployment file. In case the revision is created by a service, the field will have a "UbiOps" value.
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::revisions_get(
#'    deployment.name, revision.id, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::revisions_get(
#'    deployment.name, revision.id, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
revisions_get <- function(deployment.name, revision.id, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`revision.id`)) {
    stop("Missing required parameter `revision.id`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/revisions/{revision_id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`revision.id`)) {
    url_path <- gsub("\\{revision_id\\}", utils::URLencode(as.character(`revision.id`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List revisions
#' @description List all revisions associated with a version. A new revision is created every time a new deployment file is uploaded for a version.
#' @param deployment.name  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of details of the revisions
#'   - `id`: Unique identifier for the revision (UUID)
#'   - `version`: Version to which the revision is linked
#'   - `creation_date`: The date when the revision was created
#'   - `created_by`: The email of the user that uploaded the deployment file. In case the revision is created by a service, the field will have a "UbiOps" value.
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::revisions_list(
#'    deployment.name, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::revisions_list(
#'    deployment.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
revisions_list <- function(deployment.name, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/revisions"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}
