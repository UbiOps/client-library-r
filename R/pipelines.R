# UbiOps
#
# Client Library to interact with the UbiOps API.
#
# UbiOps API version: v2.1
# Generated by custom generator based on: https://openapi-generator.tech

# Pipelines operations


#' @title List audit events for a pipeline
#' @description List all audit events for a pipeline including objects and attachments
#' @param pipeline.name  character
#' @param action (optional) character
#' @param limit (optional) integer
#' @param offset (optional) integer
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of details of the audit events for a pipeline
#'   - `id`: Unique identifier for the audit event (UUID)
#'   - `date`: The date when the action was performed
#'   - `action`: Type of action. It can be one of: create, update, delete, info. *info* action denotes that the action does not fall into create, update or delete categories.
#'   - `user`: Email of the user who performed the action
#'   - `event`: Description of the event
#'   - `object_type`: Type of the object on which the action was performed
#'   - `object_name`: Name of the object on which the action was performed. If the object is deleted at the time of listing audit events, this field is empty.
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_audit_events_list(
#'    pipeline.name,
#'    action = NULL, limit = NULL, offset = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_audit_events_list(
#'    pipeline.name,
#'    action = NULL, limit = NULL, offset = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_audit_events_list <- function(pipeline.name, action=NULL, limit=NULL, offset=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  query_params['action'] <- action
  query_params['limit'] <- limit
  query_params['offset'] <- offset
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/audit"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create object attachments
#' @description Create an attachment between objects in a pipeline version. An attachment can only be made between objects that have already been added to the pipeline version.  The objects where the attachment starts is called the source objects. The object that is linked is called the destination object. When attaching source objects to a destination object, one must also define which source object output fields map to which destination object input fields. All the input fields in the destination object must be provided in the mapping. In contrast, not all output fields of all source objects need to be used in the mapping. It is also possible that one source output field links to multiple destination input fields.  The *pipeline_start* object can only be a source object. The *pipeline_end* object can only be a destination object.  In case of plain type of objects, the mapping `source_field_name` and `destination_field_name` must be omitted or given as null.
#' @param pipeline.name  character
#' @param version  character
#' @param data  named list of: [ destination_name, sources ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the created attachment
#'   - `destination_name`: Name of the destination pipeline object
#'   - `sources`: A list of dictionaries containing the link between a source object (source_name) and mapping of the source output field (source_field_name) and destination object input field (destination_field_name)
#' @examples
#' \dontrun{
#' data <- list(
#'  destination_name = "destination_name",
#'  sources = list(  # (optional)
#'    list(
#'      source_name = "source_name",
#'      mapping = list(  # (optional)
#'        list(
#'          source_field_name = "source_field_name",
#'          destination_field_name = "destination_field_name"
#'        )
#'      )
#'    )
#'  )
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_object_attachments_create(
#'    pipeline.name, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_object_attachments_create(
#'    pipeline.name, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_object_attachments_create <- function(pipeline.name, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/attachments"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete object attachment
#' @description Delete an attachment in a pipeline version. The referenced and original objects of the attachment still exist in the pipeline version, only the link between them is deleted.
#' @param attachment.id  character
#' @param pipeline.name  character
#' @param version  character
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' ubiops::pipeline_version_object_attachments_delete(
#'    attachment.id, pipeline.name, version
#' )
#' 
#' # Or provide directly
#' ubiops::pipeline_version_object_attachments_delete(
#'    attachment.id, pipeline.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_object_attachments_delete <- function(attachment.id, pipeline.name, version,  ...){
  query_params <- list()

  if (missing(`attachment.id`)) {
    stop("Missing required parameter `attachment.id`.")
  }
  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/attachments/{attachment_id}"
  if (!missing(`attachment.id`)) {
    url_path <- gsub("\\{attachment_id\\}", utils::URLencode(as.character(`attachment.id`), reserved = TRUE), url_path)
  }
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "DELETE", NULL, query_params, ...)
  return(invisible(NULL))
}


#' @title List the attachments of a destination object
#' @description List attachments of a destination object in a pipeline version
#' @param destination.name  character
#' @param pipeline.name  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of details of the attachments of the given destination object in the pipeline version
#'   - `destination_name`: Name of the destination object
#'   - `sources`: A list of dictionaries containing the link between a source object (source_name) and mapping of the source output field (source_field_name) and destination object input field (destination_field_name)
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_object_attachments_destination_get(
#'    destination.name, pipeline.name, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_object_attachments_destination_get(
#'    destination.name, pipeline.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_object_attachments_destination_get <- function(destination.name, pipeline.name, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`destination.name`)) {
    stop("Missing required parameter `destination.name`.")
  }
  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/objects/{destination_name}/attachments"
  if (!missing(`destination.name`)) {
    url_path <- gsub("\\{destination_name\\}", utils::URLencode(as.character(`destination.name`), reserved = TRUE), url_path)
  }
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Get object attachment
#' @description Get the details of a single attachment in a pipeline
#' @param attachment.id  character
#' @param pipeline.name  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the attachment
#'   - `destination_name`: Name of the destination pipeline object
#'   - `sources`: A list of dictionaries containing the link between a source object (source_name) and mapping of the source output field (source_field_name) and destination object input field (destination_field_name)
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_object_attachments_get(
#'    attachment.id, pipeline.name, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_object_attachments_get(
#'    attachment.id, pipeline.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_object_attachments_get <- function(attachment.id, pipeline.name, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`attachment.id`)) {
    stop("Missing required parameter `attachment.id`.")
  }
  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/attachments/{attachment_id}"
  if (!missing(`attachment.id`)) {
    url_path <- gsub("\\{attachment_id\\}", utils::URLencode(as.character(`attachment.id`), reserved = TRUE), url_path)
  }
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List object attachments
#' @description List all attachments in a pipeline version
#' @param pipeline.name  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of details of the attachments in the pipeline
#'   - `destination_name`: Name of the destination pipeline object
#'   - `sources`: A list of dictionaries containing the source object(s) and mapping of the fields. One attachment can have multiple source objects.
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_object_attachments_list(
#'    pipeline.name, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_object_attachments_list(
#'    pipeline.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_object_attachments_list <- function(pipeline.name, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/attachments"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List pipeline object environment variables
#' @description List environment variables accessible to objects in the pipeline version
#' @param name  character
#' @param pipeline.name  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of variables described by the following fields:
#'   - `id`: Unique identifier for the environment variable
#'   - `name`: Variable name
#'   - `value`: Variable value (will be null for secret variables)
#'   - `secret`: Boolean that indicates if this variable contains sensitive information
#'   - `inheritance_type`: Type of parent object that this variable is inherited from - can be `project`, `deployment`, or `version`
#'   - `inheritance_name`: Name of the parent object that this variable is inherited from
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_object_environment_variables_list(
#'    name, pipeline.name, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_object_environment_variables_list(
#'    name, pipeline.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_object_environment_variables_list <- function(name, pipeline.name, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`name`)) {
    stop("Missing required parameter `name`.")
  }
  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/objects/{name}/environment-variables"
  if (!missing(`name`)) {
    url_path <- gsub("\\{name\\}", utils::URLencode(as.character(`name`), reserved = TRUE), url_path)
  }
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create pipeline object
#' @description Create a pipeline object for a pipeline version. The pipeline object that is added is a reference to the real object. In this way, multiple references to the same object may be added to a pipeline version. The reference_name refers to the deployment name and the version is the version of the deployment which will be added to the pipeline version as an object.
#' @param pipeline.name  character
#' @param version  character
#' @param data  named list of: [ name, reference_name, version (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the created pipeline object
#'   - `id`: Unique identifier for the pipeline object (UUID)
#'   - `name`: Name of the pipeline object
#'   - `reference_name`: Name of the object it will reference
#'   - `version`: Version name of reference object
#' @examples
#' \dontrun{
#' data <- list(
#'  name = "name",
#'  reference_name = "reference_name",
#'  version = "version"  # (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_objects_create(
#'    pipeline.name, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_objects_create(
#'    pipeline.name, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_objects_create <- function(pipeline.name, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/objects"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete pipeline object
#' @description Delete a pipeline object. Only the reference in the pipeline version is deleted. The original object (deployment and version) still exists. If the object is attached to another object, the attachment is also deleted.
#' @param name  character
#' @param pipeline.name  character
#' @param version  character
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' ubiops::pipeline_version_objects_delete(
#'    name, pipeline.name, version
#' )
#' 
#' # Or provide directly
#' ubiops::pipeline_version_objects_delete(
#'    name, pipeline.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_objects_delete <- function(name, pipeline.name, version,  ...){
  query_params <- list()

  if (missing(`name`)) {
    stop("Missing required parameter `name`.")
  }
  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/objects/{name}"
  if (!missing(`name`)) {
    url_path <- gsub("\\{name\\}", utils::URLencode(as.character(`name`), reserved = TRUE), url_path)
  }
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "DELETE", NULL, query_params, ...)
  return(invisible(NULL))
}


#' @title Get pipeline object
#' @description Retrieve the details of a single pipeline object
#' @param name  character
#' @param pipeline.name  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the pipeline object
#'   - `id`: Unique identifier for the pipeline object (UUID)
#'   - `name`: Name of the pipeline object
#'   - `reference_name`: Name of the object it references
#'   - `version`: Version name of reference object
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_objects_get(
#'    name, pipeline.name, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_objects_get(
#'    name, pipeline.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_objects_get <- function(name, pipeline.name, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`name`)) {
    stop("Missing required parameter `name`.")
  }
  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/objects/{name}"
  if (!missing(`name`)) {
    url_path <- gsub("\\{name\\}", utils::URLencode(as.character(`name`), reserved = TRUE), url_path)
  }
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List pipeline objects
#' @description List all pipeline objects in a pipeline version
#' @param pipeline.name  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of details of the pipeline objects in the pipeline version
#'   - `id`: Unique identifier for the pipeline object (UUID)
#'   - `name`: Name of the pipeline object
#'   - `reference_name`: Name of the object it references
#'   - `version`: Version name of reference object
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_objects_list(
#'    pipeline.name, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_objects_list(
#'    pipeline.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_objects_list <- function(pipeline.name, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/objects"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Update pipeline object
#' @description Update a pipeline object. It is not possible to update the reference_name. All necessary fields are validated again.
#' @param name  character
#' @param pipeline.name  character
#' @param version  character
#' @param data  named list of: [ name (optional), version (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the updated pipeline object
#'   - `id`: Unique identifier for the pipeline object (UUID)
#'   - `name`: Name of the pipeline object
#'   - `reference_name`: Name of the object it references
#'   - `version`: Version name of reference object
#' @examples
#' \dontrun{
#' data <- list(
#'  name = "name",  # (optional)
#'  version = "version"  # (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_objects_update(
#'    name, pipeline.name, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_objects_update(
#'    name, pipeline.name, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_objects_update <- function(name, pipeline.name, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`name`)) {
    stop("Missing required parameter `name`.")
  }
  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/objects/{name}"
  if (!missing(`name`)) {
    url_path <- gsub("\\{name\\}", utils::URLencode(as.character(`name`), reserved = TRUE), url_path)
  }
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "PATCH", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create pipeline versions
#' @description Create a version for a pipeline. The first version of a pipeline is set as default.
#' @param pipeline.name  character
#' @param data  named list of: [ version, description (optional), labels (optional), request_retention_time (optional), request_retention_mode (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the created pipeline version
#'   - `id`: Unique identifier for the pipeline version (UUID)
#'   - `pipeline`: Name of the pipeline to which the version is associated
#'   - `version`: Name of the version of the pipeline
#'   - `description`: Description of the pipeline version
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the pipeline version was created
#'   - `last_updated`: The date when the pipeline version was last updated
#'   - `request_retention_time`: Number of seconds to store requests to the pipeline version
#'   - `request_retention_mode`: Mode of request retention for requests to the pipeline version. It can be one of the following: *none*, *metadata* or *full*.
#' @examples
#' \dontrun{
#' data <- list(
#'  version = "version",
#'  description = "description",  # (optional)
#'  labels = list(key = "value"),  # (optional)
#'  request_retention_time = 0,  # [min: 3.6E+3; max: 2.4192E+6] (optional)
#'  request_retention_mode = 'full'  # one of: [none, metadata, full]  (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_versions_create(
#'    pipeline.name, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_versions_create(
#'    pipeline.name, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_versions_create <- function(pipeline.name, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete pipeline version
#' @description Delete a pipeline version. This will also delete all objects and attachments in the pipeline version.
#' @param pipeline.name  character
#' @param version  character
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' ubiops::pipeline_versions_delete(
#'    pipeline.name, version
#' )
#' 
#' # Or provide directly
#' ubiops::pipeline_versions_delete(
#'    pipeline.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_versions_delete <- function(pipeline.name, version,  ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "DELETE", NULL, query_params, ...)
  return(invisible(NULL))
}


#' @title Get pipeline version
#' @description Get the details of a single pipeline version
#' @param pipeline.name  character
#' @param version  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the pipeline version
#'   - `id`: Unique identifier for the pipeline version (UUID)
#'   - `pipeline`: Name of the pipeline to which the version is associated
#'   - `version`: Name of the version of the pipeline
#'   - `description`: Description of the pipeline version
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the pipeline version was created
#'   - `last_updated`: The date when the pipeline version was last updated
#'   - `request_retention_time`: Number of seconds to store requests to the pipeline version
#'   - `request_retention_mode`: Mode of request retention for requests to the pipeline version. It can be one of the following:
#'       - *none* - the requests will not be stored
#'       - *metadata* - only the metadata of the requests will be stored
#'       - *full* - both the metadata and input/output of the requests will be stored
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_versions_get(
#'    pipeline.name, version
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_versions_get(
#'    pipeline.name, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_versions_get <- function(pipeline.name, version,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List pipeline versions
#' @description Pipeline versions can be filtered according to the labels they have by giving labels as a query parameter. Pipeline versions that have at least one of the labels on which is filtered, are returned.
#' @param pipeline.name  character
#' @param labels (optional) character - Example: "label1:value1,label2:value2"
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of details of the versions of the pipeline
#'   - `id`: Unique identifier for the pipeline version (UUID)
#'   - `pipeline`: Name of the pipeline to which the version is associated
#'   - `version`: Name of the version of the pipeline
#'   - `description`: Description of the pipeline version
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the pipeline version was created
#'   - `last_updated`: The date when the pipeline version was last updated
#'   - `request_retention_time`: Number of seconds to store requests to the pipeline version
#'   - `request_retention_mode`: Mode of request retention for requests to the pipeline version. It can be one of the following:
#'       - *none* - the requests will not be stored
#'       - *metadata* - only the metadata of the requests will be stored
#'       - *full* - both the metadata and input/output of the requests will be stored
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_versions_list(
#'    pipeline.name,
#'    labels = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_versions_list(
#'    pipeline.name,
#'    labels = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_versions_list <- function(pipeline.name, labels=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  query_params['labels'] <- labels
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Update pipeline version
#' @description Update a pipeline version. When updating labels, the labels will replace the existing value for labels.
#' @param pipeline.name  character
#' @param version  character
#' @param data  named list of: [ version (optional), description (optional), labels (optional), request_retention_time (optional), request_retention_mode (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the created pipeline
#'   - `id`: Unique identifier for the pipeline version (UUID)
#'   - `pipeline`: Name of the pipeline to which the version is associated
#'   - `version`: Name of the version of the pipeline
#'   - `description`: Description of the pipeline version
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the pipeline version was created
#'   - `last_updated`: The date when the pipeline version was last updated
#'   - `request_retention_time`: Number of seconds to store requests to the pipeline version
#'   - `request_retention_mode`: Mode of request retention for requests to the pipeline version. It can be one of the following: *none*, *metadata* or *full*.
#' @examples
#' \dontrun{
#' data <- list(
#'  version = "version",  # (optional)
#'  description = "description",  # (optional)
#'  labels = list(key = "value"),  # (optional)
#'  request_retention_time = 0,  # [min: 3.6E+3; max: 2.4192E+6] (optional)
#'  request_retention_mode = "request_retention_mode"  # one of: [none, metadata, full]  (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_versions_update(
#'    pipeline.name, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_versions_update(
#'    pipeline.name, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_versions_update <- function(pipeline.name, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "PATCH", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create pipelines
#' @description Create a pipeline in a project.   The input_fields represent the fields that the input data for pipeline requests should contain. When an object is attached to the pipeline, it means that the input data will be forwarded to these objects.
#' @param data  named list of: [ name, description (optional), input_type, input_fields (optional), output_type (optional), output_fields (optional), labels (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the created pipeline
#'   - `id`: Unique identifier for the pipeline (UUID)
#'   - `name`: Name of the pipeline
#'   - `description`: Description of the pipeline
#'   - `project`: Project name in which the pipeline is created
#'   - `input_type`: Type of the pipeline input
#'   - `input_fields`: A list of pipeline input fields with name and data_type
#'   - `output_type`: Type of the pipeline output
#'   - `output_fields`: A list of pipeline output fields with name and data_type
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the pipeline was created
#'   - `last_updated`: The date when the pipeline was last updated
#' @examples
#' \dontrun{
#' data <- list(
#'  name = "name",
#'  description = "description",  # (optional)
#'  input_type = "input_type",  # one of: [structured, plain] 
#'  input_fields = list(  # (optional)
#'    list(
#'      name = "name",
#'      data_type = "data_type"  # one of: [int, string, double, bool, array_int, array_double, array_string, blob] 
#'    )
#'  ),
#'  output_type = "output_type",  # one of: [structured, plain]  (optional)
#'  output_fields = list(  # (optional)
#'    list(
#'      name = "name",
#'      data_type = "data_type"  # one of: [int, string, double, bool, array_int, array_double, array_string, blob] 
#'    )
#'  ),
#'  labels = list(key = "value")  # (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipelines_create(
#'    data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipelines_create(
#'    data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipelines_create <- function(data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/pipelines"

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete a pipeline
#' @description Delete a pipeline. This will also delete all versions of the pipeline.
#' @param pipeline.name  character
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' ubiops::pipelines_delete(
#'    pipeline.name
#' )
#' 
#' # Or provide directly
#' ubiops::pipelines_delete(
#'    pipeline.name,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipelines_delete <- function(pipeline.name,  ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "DELETE", NULL, query_params, ...)
  return(invisible(NULL))
}


#' @title Get details of a pipeline
#' @description Get the details of a single pipeline
#' @param pipeline.name  character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the pipeline
#'   - `id`: Unique identifier for the pipeline (UUID)
#'   - `name`: Name of the pipeline
#'   - `description` Description of the pipeline
#'   - `project`: Project name in which the pipeline is defined
#'   - `input_type`: Type of the pipeline input
#'   - `input_fields`: A list of pipeline input fields with name and data_type
#'   - `output_type`: Type of the pipeline output
#'   - `output_fields`: A list of pipeline output fields with name and data_type
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the pipeline was created
#'   - `last_updated`: The date when the pipeline was last updated
#'   - `default_version`: Default version of the pipeline.  If it does not have a default version, it is not set.
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipelines_get(
#'    pipeline.name
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipelines_get(
#'    pipeline.name,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipelines_get <- function(pipeline.name,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List pipelines
#' @description Pipelines can be filtered according to the labels they have by giving labels as a query parameter. Pipelines that have at least one of the labels on which is filtered, are returned.
#' @param labels (optional) character - Example: "label1:value1,label2:value2"
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of details of the pipelines in the project
#'   - `id`: Unique identifier for the pipeline (UUID)
#'   - `name`: Name of the pipeline
#'   - `project`: Project name in which the pipeline is defined
#'   - `description`: Description of the pipeline
#'   - `input_type`: Type of the pipeline input
#'   - `input_fields`: A list of pipeline input fields with name and data_type
#'   - `output_type`: Type of the pipeline output
#'   - `output_fields`: A list of pipeline output fields with name and data_type
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the pipeline was created
#'   - `last_updated`: The date when the pipeline was last updated
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipelines_list(
#'    
#'    labels = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipelines_list(
#'    
#'    labels = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipelines_list <- function(labels=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  query_params['labels'] <- labels
  
  url_path <- "/projects/{project_name}/pipelines"

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Update a pipeline
#' @description Update a pipeline. All necessary fields are validated again. When updating labels, the labels will replace the existing value for labels.
#' @param pipeline.name  character
#' @param data  named list of: [ name (optional), description (optional), input_type (optional), input_fields (optional), output_type (optional), output_fields (optional), labels (optional), default_version (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the updated pipeline
#'   - `id`: Unique identifier for the pipeline (UUID)
#'   - `name`: Name of the pipeline
#'   - `project`: Project name in which the pipeline is defined
#'   - `description`: Description for the pipeline
#'   - `input_type`: Type of the pipeline input
#'   - `input_fields`: A list of pipeline input fields with name and data_type
#'   - `output_type`: Type of the pipeline output
#'   - `output_fields`: A list of pipeline output fields with name and data_type
#'   - `labels`: Dictionary containing key/value pairs where key indicates the label and value is the corresponding value of that label
#'   - `creation_date`: The date when the pipeline was created
#'   - `last_updated`: The date when the pipeline was last updated
#'   - `default_version`: Default version of the pipeline.  If it does not have a default version, it is not set.
#' @examples
#' \dontrun{
#' data <- list(
#'  name = "name",  # (optional)
#'  description = "description",  # (optional)
#'  input_type = "input_type",  # one of: [structured, plain]  (optional)
#'  input_fields = list(  # (optional)
#'    list(
#'      name = "name",
#'      data_type = "data_type"  # one of: [int, string, double, bool, array_int, array_double, array_string, blob] 
#'    )
#'  ),
#'  output_type = "output_type",  # one of: [structured, plain]  (optional)
#'  output_fields = list(  # (optional)
#'    list(
#'      name = "name",
#'      data_type = "data_type"  # one of: [int, string, double, bool, array_int, array_double, array_string, blob] 
#'    )
#'  ),
#'  labels = list(key = "value"),  # (optional)
#'  default_version = "default_version"  # (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipelines_update(
#'    pipeline.name, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipelines_update(
#'    pipeline.name, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipelines_update <- function(pipeline.name, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "PATCH", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}
