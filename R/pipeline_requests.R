# UbiOps
#
# Client Library to interact with the UbiOps API.
#
# UbiOps API version: v2.1
# Generated by custom generator based on: https://openapi-generator.tech

# PipelineRequests operations


#' @title Create a batch pipeline request
#' @description Make a batch request to the default version of a pipeline. The request follows an asynchronous method, as the requests are queued in our back-end and can be collected at a later time using the pipeline request collect methods.  The maximum number of requests that can be created per batch is 250.
#' @param pipeline.name  character
#' @param data  list() - Example: list( list(input_field_1 = "input_value_1", input_field_2 = "input_value_2") )
#' @param timeout (optional) integer
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of dictionaries containing the details of the created pipeline requests with the following fields:
#'    - `id`: Unique identifier for the pipeline request, which can be used to collect the result
#'    - `pipeline`: Name of the pipeline for which the request is made
#'    - `version`: Name of the pipeline version for which the request is made
#'    - `status`: Status of the request. Always 'pending' when initialised, later it can be 'processing', 'failed' or 'completed'.
#'    - `time_created`: Server time that the request was made (current time)
#' @examples
#' \dontrun{
#' data <- list( list(input_field_1 = "input_value_1", input_field_2 = "input_value_2") )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::batch_pipeline_requests_create(
#'    pipeline.name, data,
#'    timeout = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::batch_pipeline_requests_create(
#'    pipeline.name, data,
#'    timeout = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
batch_pipeline_requests_create <- function(pipeline.name, data, timeout=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  query_params['timeout'] <- timeout
  
  if (typeof(data) == "character") {
    content_type <- httr::content_type("text/plain")
    body <- data
  } else {
    content_type <- NULL
    body <- rjson::toJSON(data)
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/requests/batch"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, content_type, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create a batch pipeline version request
#' @description Make a batch request to a pipeline version. The request follows an asynchronous method, as the requests are queued in our back-end and can be collected at a later time using the pipeline version request collect methods.  The maximum number of requests that can be created per batch is 250.
#' @param pipeline.name  character
#' @param version  character
#' @param data  list() - Example: list( list(input_field_1 = "input_value_1", input_field_2 = "input_value_2") )
#' @param timeout (optional) integer
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of dictionaries containing the details of the created pipeline version requests with the following fields:
#'    - `id`: Unique identifier for the pipeline version request, which can be used to collect the result
#'    - `pipeline`: Name of the pipeline for which the request is made
#'    - `version`: Name of the pipeline version for which the request is made
#'    - `status`: Status of the request. Always 'pending' when initialised, later it can be 'processing', 'failed' or 'completed'.
#'    - `time_created`: Server time that the request was made (current time)
#' @examples
#' \dontrun{
#' data <- list( list(input_field_1 = "input_value_1", input_field_2 = "input_value_2") )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::batch_pipeline_version_requests_create(
#'    pipeline.name, version, data,
#'    timeout = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::batch_pipeline_version_requests_create(
#'    pipeline.name, version, data,
#'    timeout = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
batch_pipeline_version_requests_create <- function(pipeline.name, version, data, timeout=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  query_params['timeout'] <- timeout
  
  if (typeof(data) == "character") {
    content_type <- httr::content_type("text/plain")
    body <- data
  } else {
    content_type <- NULL
    body <- rjson::toJSON(data)
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/requests/batch"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, content_type, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete multiple pipeline requests
#' @description Delete multiple pipeline requests for the default version of a pipeline. If one of the given pipeline requests does not exist, an error message is given and no request is deleted. A maximum of 100 pipeline requests can be deleted with this method.
#' @param pipeline.name  character
#' @param data  list() - Example: list("request_id_1", "request_id_2")
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' data <- list("request_id_1", "request_id_2")
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_requests_batch_delete(
#'    pipeline.name, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_requests_batch_delete(
#'    pipeline.name, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_requests_batch_delete <- function(pipeline.name, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/requests/delete"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Retrieve multiple pipeline requests
#' @description Retrieve multiple pipeline requests for the default version of a pipeline. If one of the given pipeline requests does not exist, an error message is given and no request is returned. A maximum of 100 pipeline requests can be retrieved with this method. The pipeline requests are NOT returned in the order they are given in.
#' @param pipeline.name  character
#' @param data  list() - Example: list("request_id_1", "request_id_2")
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of dictionaries containing the details of the retrieved pipeline requests with the following fields:
#'    - `id`: Unique identifier for the pipeline request
#'    - `pipeline`: Name of the pipeline for which the request is made
#'    - `version`: Name of the pipeline version for which the request was made
#'    - `status`: Status of the request. Can be 'pending', 'processing', 'failed' or 'completed'.
#'    - `success`: A boolean value that indicates whether the pipeline request was successful. NULL if the request is not yet finished.
#'    - `time_created`: Server time that the request was made (current time)
#'    - `time_started`: Server time that the processing of the request was started
#'    - `time_completed`: Server time that the processing of the request was completed
#'    - `request_data`: A dictionary (structured input type) or string (plain input type) containing the data that was sent when the request was created
#'    - `result`: A dictionary (structured output type) or string (plain output type) containing the data connected to the pipeline end
#'    - `deployment_requests`: A list of requests to the deployments in the pipeline. With the deployment request ids provided in this list, it's possible to collect the results of the deployment requests separately.
#'    - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#' @examples
#' \dontrun{
#' data <- list("request_id_1", "request_id_2")
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_requests_batch_get(
#'    pipeline.name, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_requests_batch_get(
#'    pipeline.name, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_requests_batch_get <- function(pipeline.name, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/requests/collect"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create a pipeline request
#' @description Make a direct request to the default version of a pipeline. This method returns all the results of the deployment requests made within the pipeline version.
#' @param pipeline.name  character
#' @param data  list(key = "value") - Example: list(input_field_1 = "input_value_1", input_field_2 = "input_value_2")
#' @param pipeline.timeout (optional) integer
#' @param deployment.timeout (optional) integer
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  - `id`: Unique identifier for the pipeline request
#'   - `pipeline`: Name of the pipeline for which the request is made
#'   - `version`: Name of the pipeline version for which the request is made
#'   - `success`: A boolean value that indicates whether the pipeline request was successful
#'   - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#'   - `deployment_requests`: A list of dictionaries containing the results of the deployment requests made for the version objects in the pipeline. The dictionaries contain the following fields:
#'       - `id`: Unique identifier for the deployment request
#'       - `pipeline_object`: Name of the object in the pipeline
#'       - `deployment`: Name of the deployment the request was made to
#'       - `version`: Name of the version the request was made to
#'       - `success`: A boolean value that indicates whether the deployment request was successful
#'       - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#'    - `result`: A dictionary (structured output type) or string (plain output type) containing the data connected to the pipeline end
#' @examples
#' \dontrun{
#' data <- list(input_field_1 = "input_value_1", input_field_2 = "input_value_2")
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_requests_create(
#'    pipeline.name, data,
#'    pipeline.timeout = NULL, deployment.timeout = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_requests_create(
#'    pipeline.name, data,
#'    pipeline.timeout = NULL, deployment.timeout = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_requests_create <- function(pipeline.name, data, pipeline.timeout=NULL, deployment.timeout=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  query_params['pipeline_timeout'] <- pipeline.timeout
  query_params['deployment_timeout'] <- deployment.timeout
  
  if (typeof(data) == "character") {
    content_type <- httr::content_type("text/plain")
    body <- data
  } else {
    content_type <- NULL
    body <- rjson::toJSON(data)
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/requests"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, content_type, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete a pipeline request
#' @description Delete a request for the default version of a pipeline. This action deletes all the deployment requests in the pipeline.
#' @param pipeline.name  character
#' @param request.id  character
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' ubiops::pipeline_requests_delete(
#'    pipeline.name, request.id
#' )
#' 
#' # Or provide directly
#' ubiops::pipeline_requests_delete(
#'    pipeline.name, request.id,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_requests_delete <- function(pipeline.name, request.id,  ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`request.id`)) {
    stop("Missing required parameter `request.id`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/requests/{request_id}"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`request.id`)) {
    url_path <- gsub("\\{request_id\\}", utils::URLencode(as.character(`request.id`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "DELETE", NULL, query_params, ...)
  return(invisible(NULL))
}


#' @title Get a pipeline request
#' @description Get a request for the default version of a pipeline. With this method, the result of the request may be retrieved.
#' @param pipeline.name  character
#' @param request.id  character
#' @param metadata.only (optional) character ("true"|"false")
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A dictionary containing the details of the pipeline request with the following fields:
#'    - `id`: Unique identifier for the pipeline request
#'    - `pipeline`: Name of the pipeline for which the request is made
#'    - `version`: Name of the pipeline version for which the request was made
#'    - `status`: Status of the request. Can be 'pending', 'processing', 'failed' or 'completed'.
#'    - `success`: A boolean value that indicates whether the pipeline request was successful. NULL if the request is not yet finished.
#'    - `time_created`: Server time that the request was made (current time)
#'    - `time_started`: Server time that the processing of the request was started
#'    - `time_completed`: Server time that the processing of the request was completed
#'    - `request_data`: A dictionary (structured input type) or string (plain input type) containing the data that was sent when the request was created
#'    - `deployment_requests`: A list of requests of the deployments in the pipeline. With the deployment request ids provided in this list, it's possible to collect the results of the deployment requests separately.
#'    - `result`: A dictionary (structured output type) or string (plain output type) containing the data connected to the pipeline end
#'    - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#'    - `created_by`: The email of the user that created the request. In case the request is created by a service, the field will have a "UbiOps" value.
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_requests_get(
#'    pipeline.name, request.id,
#'    metadata.only = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_requests_get(
#'    pipeline.name, request.id,
#'    metadata.only = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_requests_get <- function(pipeline.name, request.id, metadata.only=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`request.id`)) {
    stop("Missing required parameter `request.id`.")
  }
  query_params['metadata_only'] <- metadata.only
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/requests/{request_id}"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`request.id`)) {
    url_path <- gsub("\\{request_id\\}", utils::URLencode(as.character(`request.id`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List pipeline requests
#' @description List all requests for the default version of a pipeline
#' @param pipeline.name  character
#' @param status (optional) character
#' @param success (optional) character ("true"|"false")
#' @param limit (optional) integer
#' @param offset (optional) integer
#' @param sort (optional) character
#' @param start.date (optional) character
#' @param end.date (optional) character
#' @param search.id (optional) character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of dictionaries containing the details of the pipeline requests with the following fields:
#'    - `id`: Unique identifier for the pipeline request
#'    - `pipeline`: Name of the pipeline for which the request is made
#'    - `version`: Name of the pipeline version for which the request was made
#'    - `status`: Status of the request
#'    - `success`: A boolean value that indicates whether the pipeline request was successful. NULL if the request is not yet finished.
#'    - `time_created`: Server time that the request was made (current time)
#'    - `time_started`: Server time that the processing of the request was started
#'    - `time_completed`: Server time that the processing of the request was completed
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_requests_list(
#'    pipeline.name,
#'    status = NULL, success = NULL, limit = NULL, offset = NULL, sort = NULL, start.date = NULL, end.date = NULL, search.id = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_requests_list(
#'    pipeline.name,
#'    status = NULL, success = NULL, limit = NULL, offset = NULL, sort = NULL, start.date = NULL, end.date = NULL, search.id = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_requests_list <- function(pipeline.name, status=NULL, success=NULL, limit=NULL, offset=NULL, sort=NULL, start.date=NULL, end.date=NULL, search.id=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  query_params['status'] <- status
  query_params['success'] <- success
  query_params['limit'] <- limit
  query_params['offset'] <- offset
  query_params['sort'] <- sort
  query_params['start_date'] <- start.date
  query_params['end_date'] <- end.date
  query_params['search_id'] <- search.id
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/requests"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete multiple pipeline version requests
#' @description Delete multiple requests for a pipeline version. If one of the given pipeline requests does not exist, an error message is given and no request is deleted. A maximum of 100 pipeline requests can be deleted with this method.
#' @param pipeline.name  character
#' @param version  character
#' @param data  list() - Example: list("request_id_1", "request_id_2")
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' data <- list("request_id_1", "request_id_2")
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_requests_batch_delete(
#'    pipeline.name, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_requests_batch_delete(
#'    pipeline.name, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_requests_batch_delete <- function(pipeline.name, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/requests/delete"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Retrieve multiple pipeline version requests
#' @description Retrieve multiple requests for a pipeline version. If one of the given pipeline requests does not exist, an error message is given and no request is returned. A maximum of 100 pipeline version requests can be retrieved with this method. The pipeline version requests are NOT returned in the order they are given in.
#' @param pipeline.name  character
#' @param version  character
#' @param data  list() - Example: list("request_id_1", "request_id_2")
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of dictionaries containing the details of the retrieved pipeline requests with the following fields:
#'    - `id`: Unique identifier for the pipeline request
#'    - `pipeline`: Name of the pipeline for which the request is made
#'    - `version`: Name of the pipeline version for which the request was made
#'    - `status`: Status of the request. Can be 'pending', 'processing', 'failed' or 'completed'.
#'    - `success`: A boolean value that indicates whether the pipeline request was successful. NULL if the request is not yet finished.
#'    - `time_created`: Server time that the request was made (current time)
#'    - `time_started`: Server time that the processing of the request was started
#'    - `time_completed`: Server time that the processing of the request was completed
#'    - `request_data`: A dictionary (structured input type) or string (plain input type) containing the data that was sent when the request was created
#'    - `result`: A dictionary (structured output type) or string (plain output type) containing the data connected to the pipeline end
#'    - `deployment_requests`: A list of requests to the deployments in the pipeline. With the deployment request ids provided in this list, it's possible to collect the results of the deployment requests separately.
#'    - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#' @examples
#' \dontrun{
#' data <- list("request_id_1", "request_id_2")
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_requests_batch_get(
#'    pipeline.name, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_requests_batch_get(
#'    pipeline.name, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_requests_batch_get <- function(pipeline.name, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/requests/collect"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create a pipeline version request
#' @description Make a direct request to a pipeline version. This method returns all the results of the deployment requests made within the pipeline version.
#' @param pipeline.name  character
#' @param version  character
#' @param data  list(key = "value") - Example: list(input_field_1 = "input_value_1", input_field_2 = "input_value_2")
#' @param pipeline.timeout (optional) integer
#' @param deployment.timeout (optional) integer
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  - `id`: Unique identifier for the pipeline request
#'   - `pipeline`: Name of the pipeline for which the request is made
#'   - `version`: Name of the pipeline version for which the request is made
#'   - `success`: A boolean value that indicates whether the pipeline request was successful
#'   - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#'   - `deployment_requests`: A list of dictionaries containing the results of the deployment requests made for the version objects in the pipeline. The dictionaries contain the following fields:
#'       - `id`: Unique identifier for the deployment request
#'       - `pipeline_object`: Name of the object in the pipeline
#'       - `deployment`: Name of the deployment the request was made to
#'       - `version`: Name of the version the request was made to
#'       - `success`: A boolean value that indicates whether the deployment request was successful
#'       - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#'   - `result`: A dictionary (structured output type) or string (plain output type) containing the data connected to the pipeline end
#' @examples
#' \dontrun{
#' data <- list(input_field_1 = "input_value_1", input_field_2 = "input_value_2")
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_requests_create(
#'    pipeline.name, version, data,
#'    pipeline.timeout = NULL, deployment.timeout = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_requests_create(
#'    pipeline.name, version, data,
#'    pipeline.timeout = NULL, deployment.timeout = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_requests_create <- function(pipeline.name, version, data, pipeline.timeout=NULL, deployment.timeout=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  query_params['pipeline_timeout'] <- pipeline.timeout
  query_params['deployment_timeout'] <- deployment.timeout
  
  if (typeof(data) == "character") {
    content_type <- httr::content_type("text/plain")
    body <- data
  } else {
    content_type <- NULL
    body <- rjson::toJSON(data)
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/requests"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, content_type, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete a pipeline version request
#' @description Delete a request for a pipeline version. This action deletes all the deployment requests in the pipeline.
#' @param pipeline.name  character
#' @param request.id  character
#' @param version  character
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' ubiops::pipeline_version_requests_delete(
#'    pipeline.name, request.id, version
#' )
#' 
#' # Or provide directly
#' ubiops::pipeline_version_requests_delete(
#'    pipeline.name, request.id, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_requests_delete <- function(pipeline.name, request.id, version,  ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`request.id`)) {
    stop("Missing required parameter `request.id`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/requests/{request_id}"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`request.id`)) {
    url_path <- gsub("\\{request_id\\}", utils::URLencode(as.character(`request.id`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "DELETE", NULL, query_params, ...)
  return(invisible(NULL))
}


#' @title Get a pipeline version request
#' @description Get a request for a pipeline version. With this method, the result of a request may be retrieved.
#' @param pipeline.name  character
#' @param request.id  character
#' @param version  character
#' @param metadata.only (optional) character ("true"|"false")
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A dictionary containing the details of the pipeline version request with the following fields:
#'    - `id`: Unique identifier for the pipeline version request
#'    - `pipeline`: Name of the pipeline for which the request is made
#'    - `version`: Name of the pipeline version for which the request was made
#'    - `status`: Status of the request. Can be 'pending', 'processing', 'failed' or 'completed'.
#'    - `success`: A boolean value that indicates whether the pipeline version request was successful. NULL if the request is not yet finished.
#'    - `time_created`: Server time that the request was made (current time)
#'    - `time_started`: Server time that the processing of the request was started
#'    - `time_completed`: Server time that the processing of the request was completed
#'    - `request_data`: A dictionary (structured input type) or string (plain input type) containing the data that was sent when the request was created
#'    - `deployment_requests`: A list of requests of the deployments in the pipeline. With the deployment request ids provided in this list, it's possible to collect the results of the deployment requests separately.
#'    - `result`: A dictionary (structured output type) or string (plain output type) containing the data connected to the pipeline end
#'    - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#'    - `created_by`: The email of the user that created the request. In case the request is created by a service, the field will have a "UbiOps" value.
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_requests_get(
#'    pipeline.name, request.id, version,
#'    metadata.only = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_requests_get(
#'    pipeline.name, request.id, version,
#'    metadata.only = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_requests_get <- function(pipeline.name, request.id, version, metadata.only=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`request.id`)) {
    stop("Missing required parameter `request.id`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  query_params['metadata_only'] <- metadata.only
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/requests/{request_id}"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`request.id`)) {
    url_path <- gsub("\\{request_id\\}", utils::URLencode(as.character(`request.id`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List pipeline version requests
#' @description List all batch requests for a pipeline version
#' @param pipeline.name  character
#' @param version  character
#' @param status (optional) character
#' @param success (optional) character ("true"|"false")
#' @param limit (optional) integer
#' @param offset (optional) integer
#' @param sort (optional) character
#' @param start.date (optional) character
#' @param end.date (optional) character
#' @param search.id (optional) character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of dictionaries containing the details of the pipeline version requests with the following fields:
#'    - `id`: Unique identifier for the pipeline version request
#'    - `pipeline`: Name of the pipeline for which the request is made
#'    - `version`: Name of the pipeline version for which the request was made
#'    - `status`: Status of the request
#'    - `success`: A boolean value that indicates whether the pipeline version request was successful. NULL if the request is not yet finished.
#'    - `time_created`: Server time that the request was made (current time)
#'    - `time_started`: Server time that the processing of the request was started
#'    - `time_completed`: Server time that the processing of the request was completed
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::pipeline_version_requests_list(
#'    pipeline.name, version,
#'    status = NULL, success = NULL, limit = NULL, offset = NULL, sort = NULL, start.date = NULL, end.date = NULL, search.id = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::pipeline_version_requests_list(
#'    pipeline.name, version,
#'    status = NULL, success = NULL, limit = NULL, offset = NULL, sort = NULL, start.date = NULL, end.date = NULL, search.id = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
pipeline_version_requests_list <- function(pipeline.name, version, status=NULL, success=NULL, limit=NULL, offset=NULL, sort=NULL, start.date=NULL, end.date=NULL, search.id=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`pipeline.name`)) {
    stop("Missing required parameter `pipeline.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  query_params['status'] <- status
  query_params['success'] <- success
  query_params['limit'] <- limit
  query_params['offset'] <- offset
  query_params['sort'] <- sort
  query_params['start_date'] <- start.date
  query_params['end_date'] <- end.date
  query_params['search_id'] <- search.id
  
  url_path <- "/projects/{project_name}/pipelines/{pipeline_name}/versions/{version}/requests"
  if (!missing(`pipeline.name`)) {
    url_path <- gsub("\\{pipeline_name\\}", utils::URLencode(as.character(`pipeline.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}
