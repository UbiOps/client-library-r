# UbiOps
#
# Client Library to interact with the UbiOps API.
#
# UbiOps API version: v2.1
# Generated by custom generator based on: https://openapi-generator.tech

# DeploymentRequests operations


#' @title Create a batch deployment request
#' @description Request multiple predictions from the default version of a deployment. The request follows an asynchronous method, as the requests are queued in our back-end and can be collected at a later time using the deployment request collect methods.  If one of the requests is faulty, all requests are denied. The maximum number of requests per batch call is 250.
#' @param deployment.name  character
#' @param data  list() - Example: list( list(input_field_1 = "input_value_1", input_field_2 = "input_value_2") )
#' @param timeout (optional) integer
#' @param notification.group (optional) character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of dictionaries containing the details of the created deployment requests with the following fields:
#'    - `id`: Unique identifier for the deployment request, which can be used to collect the result
#'    - `deployment`: Name of the deployment the request was made to
#'    - `version`: Name of the version the request was made to
#'    - `status`: Status of the request. Always 'pending' when initialised, later it can be 'processing', 'failed', 'completed', 'cancelled' or 'cancelled_pending'.
#'    - `time_created`: Server time that the request was made (current time)
#' @examples
#' \dontrun{
#' data <- list( list(input_field_1 = "input_value_1", input_field_2 = "input_value_2") )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::batch_deployment_requests_create(
#'    deployment.name, data,
#'    timeout = NULL, notification.group = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::batch_deployment_requests_create(
#'    deployment.name, data,
#'    timeout = NULL, notification.group = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
batch_deployment_requests_create <- function(deployment.name, data, timeout=NULL, notification.group=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  query_params['timeout'] <- timeout
  query_params['notification_group'] <- notification.group
  
  if (typeof(data) == "character") {
    content_type <- httr::content_type("text/plain")
    body <- data
  } else {
    content_type <- NULL
    body <- rjson::toJSON(data)
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/requests/batch"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, content_type, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create a batch deployment version request
#' @description Request multiple predictions from a deployment version. The request follows an asynchronous method, as the requests are queued in our back-end and can be collected at a later time using the deployment request collect methods. It is only possible to make a request if a deployment file is uploaded for that version and the deployment build has succeeded (meaning that the version is in available state).  If one of the requests is faulty, all requests are denied. The maximum number of requests per batch call is 250.
#' @param deployment.name  character
#' @param version  character
#' @param data  list() - Example: list( list(input_field_1 = "input_value_1", input_field_2 = "input_value_2") )
#' @param timeout (optional) integer
#' @param notification.group (optional) character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of dictionaries containing the details of the created deployment requests with the following fields:
#'    - `id`: Unique identifier for the deployment request, which can be used to collect the result
#'    - `deployment`: Name of the deployment the request was made to
#'    - `version`: Name of the version the request was made to
#'    - `status`: Status of the request. Always 'pending' when initialised, later it can be 'processing', 'failed', 'completed', 'cancelled' or 'cancelled_pending'.
#'    - `time_created`: Server time that the request was made (current time)
#' @examples
#' \dontrun{
#' data <- list( list(input_field_1 = "input_value_1", input_field_2 = "input_value_2") )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::batch_deployment_version_requests_create(
#'    deployment.name, version, data,
#'    timeout = NULL, notification.group = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::batch_deployment_version_requests_create(
#'    deployment.name, version, data,
#'    timeout = NULL, notification.group = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
batch_deployment_version_requests_create <- function(deployment.name, version, data, timeout=NULL, notification.group=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  query_params['timeout'] <- timeout
  query_params['notification_group'] <- notification.group
  
  if (typeof(data) == "character") {
    content_type <- httr::content_type("text/plain")
    body <- data
  } else {
    content_type <- NULL
    body <- rjson::toJSON(data)
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/requests/batch"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, content_type, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete multiple deployment requests
#' @description Delete multiple deployment requests for the default version of a deployment. If one of the given deployment requests does not exist, an error message is given and no request is deleted. A maximum of 250 deployment requests can be deleted with this method.
#' @param deployment.name  character
#' @param data  list() - Example: list("request_id_1", "request_id_2")
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' data <- list("request_id_1", "request_id_2")
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_requests_batch_delete(
#'    deployment.name, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_requests_batch_delete(
#'    deployment.name, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_requests_batch_delete <- function(deployment.name, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/requests/delete"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Retrieve multiple deployment requests
#' @description Retrieve multiple deployment requests for the default version of a deployment. If one of the given deployment requests does not exist, an error message is given and no request is returned. A maximum of 250 deployment requests can be retrieved with this method. The deployment requests are NOT returned in the order they are given in.
#' @param deployment.name  character
#' @param data  list() - Example: list("request_id_1", "request_id_2")
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of dictionaries containing the details of the retrieved deployment requests with the following fields:
#'   - `id`: Unique identifier for the deployment request
#'   - `deployment`: Name of the deployment the request was made to
#'   - `version`: Name of the version the request was made to
#'   - `status`: Status of the request. Can be 'pending', 'processing', 'failed', 'completed', 'cancelled' or 'cancelled_pending'.
#'   - `success`: A boolean value that indicates whether the deployment request was successful. NULL if the request is not yet finished.
#'   - `time_created`: Server time that the request was made (current time)
#'   - `time_started`: Server time that the processing of the request was started
#'   - `time_completed`: Server time that the processing of the request was completed
#'   - `request_data`: A dictionary containing the data that was sent when the request was created
#'   - `result`: Deployment request result value. NULL if the request is 'pending', 'processing' or 'failed'.
#'   - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#' @examples
#' \dontrun{
#' data <- list("request_id_1", "request_id_2")
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_requests_batch_get(
#'    deployment.name, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_requests_batch_get(
#'    deployment.name, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_requests_batch_get <- function(deployment.name, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/requests/collect"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create a direct deployment request
#' @description Request a prediction from a deployment. Deployment requests are made for the default version of a deployment. When using the 'requests' function of a deployment a list should be provided as input, see the example below.
#' @param deployment.name  character
#' @param data  list(key = "value") - Example: list(input_field_1 = "input_value_1", input_field_2 = "input_value_2")
#' @param timeout (optional) integer
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the created deployment request
#'   - `id`: Unique identifier for the deployment request
#'   - `deployment`: Name of the deployment the request was made to
#'   - `version`: Name of the version the request was made to
#'   - `success`: A boolean value that indicates whether the deployment request was successful
#'   - `result`: Deployment request result value. NULL if the request failed.
#'   - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#' @examples
#' \dontrun{
#' data <- list(input_field_1 = "input_value_1", input_field_2 = "input_value_2")
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_requests_create(
#'    deployment.name, data,
#'    timeout = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_requests_create(
#'    deployment.name, data,
#'    timeout = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_requests_create <- function(deployment.name, data, timeout=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  query_params['timeout'] <- timeout
  
  if (typeof(data) == "character") {
    content_type <- httr::content_type("text/plain")
    body <- data
  } else {
    content_type <- NULL
    body <- rjson::toJSON(data)
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/requests"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, content_type, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete a deployment request
#' @description Delete a deployment request for the default version of a deployment
#' @param deployment.name  character
#' @param request.id  character
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' ubiops::deployment_requests_delete(
#'    deployment.name, request.id
#' )
#' 
#' # Or provide directly
#' ubiops::deployment_requests_delete(
#'    deployment.name, request.id,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_requests_delete <- function(deployment.name, request.id,  ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`request.id`)) {
    stop("Missing required parameter `request.id`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/requests/{request_id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`request.id`)) {
    url_path <- gsub("\\{request_id\\}", utils::URLencode(as.character(`request.id`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "DELETE", NULL, query_params, ...)
  return(invisible(NULL))
}


#' @title Get a deployment request
#' @description Get a request of the default version of a deployment. With this method, the result of a request may be retrieved.
#' @param deployment.name  character
#' @param request.id  character
#' @param metadata.only (optional) character ("true"|"false")
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A dictionary containing the details of the deployment request with the following fields:
#'   - `id`: Unique identifier for the deployment request
#'   - `deployment`: Name of the deployment the request was made to
#'   - `version`: Name of the version the request was made to
#'   - `status`: Status of the request. Can be 'pending', 'processing', 'failed', 'completed', 'cancelled' or 'cancelled_pending'.
#'   - `success`: A boolean value that indicates whether the deployment request was successful. NULL if the request is not yet finished.
#'   - `time_created`: Server time that the request was made (current time)
#'   - `time_started`: Server time that the processing of the request was started
#'   - `time_completed`: Server time that the processing of the request was completed
#'   - `request_data`: A dictionary containing the data that was sent when the request was created
#'   - `result`: Deployment request result value. NULL if the request is 'pending', 'processing' or 'failed'.
#'   - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#'   - `created_by`: The email of the user that created the request. In case the request is created by a service, the field will have a "UbiOps" value.
#'   - `notification_group`: Name of a notification group to send notifications (e.g., emails) when the request is completed
#'   - `origin`: A dictionary containing the information on where the request originated from. It contains:
#'      - the deployment (and version) names if the request is directly made to the deployment
#'      - the pipeline (and version) names if the request is part of a pipeline request
#'      - the request schedule name if the request is created via a request schedule
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_requests_get(
#'    deployment.name, request.id,
#'    metadata.only = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_requests_get(
#'    deployment.name, request.id,
#'    metadata.only = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_requests_get <- function(deployment.name, request.id, metadata.only=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`request.id`)) {
    stop("Missing required parameter `request.id`.")
  }
  query_params['metadata_only'] <- metadata.only
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/requests/{request_id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`request.id`)) {
    url_path <- gsub("\\{request_id\\}", utils::URLencode(as.character(`request.id`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List deployment requests
#' @description List all requests for the default version of a deployment
#' @param deployment.name  character
#' @param status (optional) character
#' @param success (optional) character ("true"|"false")
#' @param limit (optional) integer
#' @param offset (optional) integer
#' @param sort (optional) character
#' @param pipeline (optional) character ("true"|"false")
#' @param start.date (optional) character
#' @param end.date (optional) character
#' @param search.id (optional) character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of dictionaries containing the details of the deployment requests with the following fields:
#'   - `id`: Unique identifier for the deployment request
#'   - `deployment`: Name of the deployment the request was made to
#'   - `version`: Name of the version the request was made to
#'   - `status`: Status of the request
#'   - `success`: A boolean value that indicates whether the deployment request was successful. NULL if the request is not yet finished.
#'   - `time_created`: Server time that the request was made (current time)
#'   - `time_started`: Server time that the processing of the request was started
#'   - `time_completed`: Server time that the processing of the request was completed
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_requests_list(
#'    deployment.name,
#'    status = NULL, success = NULL, limit = NULL, offset = NULL, sort = NULL, pipeline = NULL, start.date = NULL, end.date = NULL, search.id = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_requests_list(
#'    deployment.name,
#'    status = NULL, success = NULL, limit = NULL, offset = NULL, sort = NULL, pipeline = NULL, start.date = NULL, end.date = NULL, search.id = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_requests_list <- function(deployment.name, status=NULL, success=NULL, limit=NULL, offset=NULL, sort=NULL, pipeline=NULL, start.date=NULL, end.date=NULL, search.id=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  query_params['status'] <- status
  query_params['success'] <- success
  query_params['limit'] <- limit
  query_params['offset'] <- offset
  query_params['sort'] <- sort
  query_params['pipeline'] <- pipeline
  query_params['start_date'] <- start.date
  query_params['end_date'] <- end.date
  query_params['search_id'] <- search.id
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/requests"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Update a deployment request
#' @description Update a deployment request for the default version of a deployment. It is possible to **cancel** a request by giving `cancelled` in the status field.
#' @param deployment.name  character
#' @param request.id  character
#' @param data  named list of: [ status (optional), notification_group (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' data <- list(
#'  status = "status",  # one of: [cancelled]  (optional)
#'  notification_group = "notification_group"  # (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_requests_update(
#'    deployment.name, request.id, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_requests_update(
#'    deployment.name, request.id, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_requests_update <- function(deployment.name, request.id, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`request.id`)) {
    stop("Missing required parameter `request.id`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/requests/{request_id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`request.id`)) {
    url_path <- gsub("\\{request_id\\}", utils::URLencode(as.character(`request.id`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "PATCH", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete multiple deployment version requests
#' @description Delete multiple deployment requests for a deployment version. If one of the given deployment requests does not exist, an error message is given and no request is deleted. A maximum of 250 deployment requests can be deleted with this method.
#' @param deployment.name  character
#' @param version  character
#' @param data  list() - Example: list("request_id_1", "request_id_2")
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' data <- list("request_id_1", "request_id_2")
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_version_requests_batch_delete(
#'    deployment.name, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_version_requests_batch_delete(
#'    deployment.name, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_requests_batch_delete <- function(deployment.name, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/requests/delete"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Retrieve multiple deployment version requests
#' @description Retrieve multiple deployment requests for a deployment version. If one of the given deployment requests does not exist, an error message is given and no request is returned. A maximum of 250 deployment requests can be retrieved with this method. The deployment requests are NOT returned in the order they are given in.
#' @param deployment.name  character
#' @param version  character
#' @param data  list() - Example: list("request_id_1", "request_id_2")
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of dictionaries containing the details of the retrieved deployment requests with the following fields:
#'    - `id`: Unique identifier for the deployment request
#'    - `deployment`: Name of the deployment the request was made to
#'    - `version`: Name of the version the request was made to
#'    - `status`: Status of the request. Can be 'pending', 'processing', 'failed', 'completed', 'cancelled' or 'cancelled_pending'.
#'    - `success`: A boolean value that indicates whether the deployment request was successful. NULL if the request is not yet finished.
#'    - `time_created`: Server time that the request was made (current time)
#'    - `time_started`: Server time that the processing of the request was started
#'    - `time_completed`: Server time that the processing of the request was completed
#'    - `request_data`: A dictionary containing the data that was sent when the request was created
#'    - `result`: Deployment request result value. NULL if the request is 'pending', 'processing' or 'failed'.
#'    - `error_message`: An error message explaining why the request has failed. NULL if the request was successful. 
#'    - `retries`: Number of times that the request has been retried
#' @examples
#' \dontrun{
#' data <- list("request_id_1", "request_id_2")
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_version_requests_batch_get(
#'    deployment.name, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_version_requests_batch_get(
#'    deployment.name, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_requests_batch_get <- function(deployment.name, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/requests/collect"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Create a direct deployment version request
#' @description Request a prediction from a deployment version. It is only possible to make a request if a deployment file is uploaded for that version and the deployment build has succeeded (meaning that the version is in available state). When using the 'requests' function of a deployment a list should be provided as input, see the example below.
#' @param deployment.name  character
#' @param version  character
#' @param data  list(key = "value") - Example: list(input_field_1 = "input_value_1", input_field_2 = "input_value_2")
#' @param timeout (optional) integer
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  Details of the created deployment request
#'   - `id`: Unique identifier for the deployment request
#'   - `deployment`: Name of the deployment the request was made to
#'   - `version`: Name of the version the request was made to
#'   - `success`: A boolean value that indicates whether the deployment request was successful
#'   - `result`: Deployment request result value. NULL if the request failed.
#'   - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#' @examples
#' \dontrun{
#' data <- list(input_field_1 = "input_value_1", input_field_2 = "input_value_2")
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_version_requests_create(
#'    deployment.name, version, data,
#'    timeout = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_version_requests_create(
#'    deployment.name, version, data,
#'    timeout = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_requests_create <- function(deployment.name, version, data, timeout=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  query_params['timeout'] <- timeout
  
  if (typeof(data) == "character") {
    content_type <- httr::content_type("text/plain")
    body <- data
  } else {
    content_type <- NULL
    body <- rjson::toJSON(data)
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/requests"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "POST", body, query_params, content_type, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Delete a deployment version request
#' @description Delete a deployment request for a deployment version
#' @param deployment.name  character
#' @param request.id  character
#' @param version  character
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' ubiops::deployment_version_requests_delete(
#'    deployment.name, request.id, version
#' )
#' 
#' # Or provide directly
#' ubiops::deployment_version_requests_delete(
#'    deployment.name, request.id, version,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_requests_delete <- function(deployment.name, request.id, version,  ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`request.id`)) {
    stop("Missing required parameter `request.id`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/requests/{request_id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`request.id`)) {
    url_path <- gsub("\\{request_id\\}", utils::URLencode(as.character(`request.id`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "DELETE", NULL, query_params, ...)
  return(invisible(NULL))
}


#' @title Get a deployment version request
#' @description Get a request for a deployment version. With this method, the result of a request may be retrieved.
#' @param deployment.name  character
#' @param request.id  character
#' @param version  character
#' @param metadata.only (optional) character ("true"|"false")
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A dictionary containing the details of the deployment request with the following fields:
#'    - `id`: Unique identifier for the deployment request
#'    - `deployment`: Name of the deployment the request was made to
#'    - `version`: Name of the version the request was made to
#'    - `status`: Status of the request. Can be 'pending', 'processing', 'failed', 'completed', 'cancelled' or 'cancelled_pending'.
#'    - `success`: A boolean value that indicates whether the deployment request was successful. NULL if the request is not yet finished.
#'    - `time_created`: Server time that the request was made (current time)
#'    - `time_started`: Server time that the processing of the request was started
#'    - `time_completed`: Server time that the processing of the request was completed
#'    - `request_data`: A dictionary containing the data that was sent when the request was created
#'    - `result`: Deployment request result value. NULL if the request is 'pending', 'processing' or 'failed'.
#'    - `error_message`: An error message explaining why the request has failed. NULL if the request was successful.
#'    - `created_by`: The email of the user that created the request. In case the request is created by a service, the field will have a "UbiOps" value.
#'    - `notification_group`: Name of a notification group to send notifications (e.g., emails) when the request is completed
#'    - `retries`: Number of times that the request has been retried
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_version_requests_get(
#'    deployment.name, request.id, version,
#'    metadata.only = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_version_requests_get(
#'    deployment.name, request.id, version,
#'    metadata.only = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_requests_get <- function(deployment.name, request.id, version, metadata.only=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`request.id`)) {
    stop("Missing required parameter `request.id`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  query_params['metadata_only'] <- metadata.only
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/requests/{request_id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`request.id`)) {
    url_path <- gsub("\\{request_id\\}", utils::URLencode(as.character(`request.id`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title List deployment version requests
#' @description List all requests for a deployment version
#' @param deployment.name  character
#' @param version  character
#' @param status (optional) character
#' @param success (optional) character ("true"|"false")
#' @param limit (optional) integer
#' @param offset (optional) integer
#' @param sort (optional) character
#' @param pipeline (optional) character ("true"|"false")
#' @param start.date (optional) character
#' @param end.date (optional) character
#' @param search.id (optional) character
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#'  A list of dictionaries containing the details of the deployment requests with the following fields:
#'    - `id`: Unique identifier for the deployment request
#'    - `deployment`: Name of the deployment the request was made to
#'    - `version`: Name of the version the request was made to
#'    - `status`: Status of the request
#'    - `success`: A boolean value that indicates whether the deployment request was successful. NULL if the request is not yet finished.
#'    - `time_created`: Server time that the request was made (current time)
#'    - `time_started`: Server time that the processing of the request was started
#'    - `time_completed`: Server time that the processing of the request was completed
#' @examples
#' \dontrun{
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_version_requests_list(
#'    deployment.name, version,
#'    status = NULL, success = NULL, limit = NULL, offset = NULL, sort = NULL, pipeline = NULL, start.date = NULL, end.date = NULL, search.id = NULL
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_version_requests_list(
#'    deployment.name, version,
#'    status = NULL, success = NULL, limit = NULL, offset = NULL, sort = NULL, pipeline = NULL, start.date = NULL, end.date = NULL, search.id = NULL, 
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_requests_list <- function(deployment.name, version, status=NULL, success=NULL, limit=NULL, offset=NULL, sort=NULL, pipeline=NULL, start.date=NULL, end.date=NULL, search.id=NULL,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  query_params['status'] <- status
  query_params['success'] <- success
  query_params['limit'] <- limit
  query_params['offset'] <- offset
  query_params['sort'] <- sort
  query_params['pipeline'] <- pipeline
  query_params['start_date'] <- start.date
  query_params['end_date'] <- end.date
  query_params['search_id'] <- search.id
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/requests"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "GET", NULL, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}


#' @title Update a deployment version request
#' @description Update a deployment request for a deployment version. It is possible to **cancel** a request by giving `cancelled` in the status field.
#' @param deployment.name  character
#' @param request.id  character
#' @param version  character
#' @param data  named list of: [ status (optional), notification_group (optional) ]
#' @param preload_content (optional) Whether the API response should be preloaded. When TRUE the JSON response string is parsed to an R object. When FALSE, unprocessed API response object is returned. - Default = TRUE
#' @param ...
#'  UBIOPS_PROJECT (system environment variable) UbiOps project name
#'  UBIOPS_API_TOKEN (system environment variable) Token to connect to UbiOps API
#'  UBIOPS_API_URL (optional - system environment variable) UbiOps API url - Default = "https://api.ubiops.com/v2.1"
#'  UBIOPS_TIMEOUT (optional - system environment variable) Maximum request timeout to connect to UbiOps API - Default = NA
#'  UBIOPS_DEFAULT_HEADERS (optional - system environment variable) Default headers to pass to UbiOps API, formatted like "header1:value1,header2:value2" - Default = ""
#' @return Response from the API
#' @examples
#' \dontrun{
#' data <- list(
#'  status = "status",  # one of: [cancelled]  (optional)
#'  notification_group = "notification_group"  # (optional)
#' )
#'
#' # Use environment variables
#' Sys.setenv("UBIOPS_PROJECT" = "YOUR PROJECT NAME")
#' Sys.setenv("UBIOPS_API_TOKEN" = "YOUR API TOKEN")
#' result <- ubiops::deployment_version_requests_update(
#'    deployment.name, request.id, version, data
#' )
#' 
#' # Or provide directly
#' result <- ubiops::deployment_version_requests_update(
#'    deployment.name, request.id, version, data,
#'    UBIOPS_PROJECT = "YOUR PROJECT NAME", UBIOPS_API_TOKEN = "YOUR API TOKEN"
#' )
#' 
#' print(result)
#' 
#' # The default API url is https://api.ubiops.com/v2.1
#' # Want to use a different API url?
#' # Provide `UBIOPS_API_URL`, either directly or as environment variable.
#' }
#' @export
deployment_version_requests_update <- function(deployment.name, request.id, version, data,  preload_content=TRUE, ...){
  query_params <- list()

  if (missing(`deployment.name`)) {
    stop("Missing required parameter `deployment.name`.")
  }
  if (missing(`request.id`)) {
    stop("Missing required parameter `request.id`.")
  }
  if (missing(`version`)) {
    stop("Missing required parameter `version`.")
  }
  if (missing(`data`)) {
    stop("Missing required parameter `data`.")
  }
  
  body <- rjson::toJSON(data)
  
  url_path <- "/projects/{project_name}/deployments/{deployment_name}/versions/{version}/requests/{request_id}"
  if (!missing(`deployment.name`)) {
    url_path <- gsub("\\{deployment_name\\}", utils::URLencode(as.character(`deployment.name`), reserved = TRUE), url_path)
  }
  if (!missing(`request.id`)) {
    url_path <- gsub("\\{request_id\\}", utils::URLencode(as.character(`request.id`), reserved = TRUE), url_path)
  }
  if (!missing(`version`)) {
    url_path <- gsub("\\{version\\}", utils::URLencode(as.character(`version`), reserved = TRUE), url_path)
  }

  api.response <- call_api(url_path, "PATCH", body, query_params, ...)
  if (preload_content) {
    deserializedRespObj <- tryCatch(
      deserialize(api.response),
      error = function(e){
        stop("Failed to deserialize response")
      }
    )

  } else {
    ApiResponse$new(api.response)
  }
}
